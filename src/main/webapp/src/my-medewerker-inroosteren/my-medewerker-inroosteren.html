<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-time-input/paper-time-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">



<dom-module id="my-medewerker-inroosteren">
    <template>
        <style>
            :host {
                display: block;
            }

            paper-button{
                background-color: #fff;
                color: #404040;
            }
            paper-input{
             text-align: center;
            }
            vaadin-combo-box{
                width: 300px;
            }

            .dag{
                width: 150px;
                text-align: center;
            }
            .begintijd{
                width: 100px;
                text-align: center;

            }
            .pauze{
                width:100px;
                text-align: center;
            }

            .eindtijd{
                width: 100px;
                text-align: center;

            }
            .vast{
                width: 25px;
                text-align: center;
            }
            .space{
                width:10px;
            }
            paper-time-input{
                max-width: 100px;
                margin: 0 auto;
                padding: 10px;
            }

        </style>
        <table>
            <tr>
                <td>
                    <vaadin-combo-box id="medewerker" label="medewerker" items="[[_c_medewerkers]]" item-value-path="naam" item-label-path="naam">
                        <template>
                            [[item.naam]]
                        </template>
                    </vaadin-combo-box>
                </td>
                <td class="space"></td>
                <td>
                    <input type="week" id="date" />
                </td>
                <td><button on-click="medewerker_rooster_ophalen"></button></td>
            </tr>
        </table>on-change="medewerker_rooster_ophalen"

        <div class="my-title">rooster medewerker</div>
        <br>
        <table hidden$="{{hide}}">
            <tr>
                <th class="dag">Dag</th>
                <th class="begintijd">Begintijd</th>
                <th class="pauze">Pauze</th>
                <th class="eindtijd">Eindtijd</th>
                <th class="vast">Vast</th>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Maandag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input format="24" autoValidate="true" hour="[[_result.mabegintijdh]]" min="[[_result.mabegintijdm]]"></paper-time-input>
                </td>
                <td class="pauze" >
                    <paper-time-input items="[[_result]]" format="24" autoValidate="true"hour="[[item.mapauzeh]]" min="[[item.mapauzem]]"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"hour="[[item.maeindtijdh]]" min="[[item.maeindtijdm]]"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox checked="[[item.mavast]]"></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Dinsdag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Woensdag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Donderdag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Vrijdag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Zaterdag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table>
        <table hidden$="{{hide}}">
            <tr>
                <td class="dag">
                    <label >Zondag</label>
                </td>
                <td class="begintijd">
                    <paper-time-input  format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="eindtijd" >
                    <paper-time-input format="24" autoValidate="true"></paper-time-input>
                </td>
                <td class="vast">
                    <paper-checkbox></paper-checkbox>
                </td>
            </tr>
        </table >
        <br>

            <paper-button hidden$="{{hide}}" on-tap="">inroosteren</paper-button>

        </div>

        <iron-ajax
                id="ajax_medewerkers_ophalen"
                method="POST"
                url="/services/persoon/medewerkers/ophalen"
                handle-as="json"
                on-response="_medewerkers_ophalen_response_handler">
        </iron-ajax>

        <iron-ajax
                id="ajax_rooster_ophalen"
                method="POST"
                url="/services/rooster/medewerkers/ophalen"
                handle-as="json"
                on-response="_rooster_medewerker_ophalen_response_handler">
        </iron-ajax>

    </template>

    <script>
        Polymer({
            is: "my-medewerker-inroosteren",
            properties: {
                _c_medewerkers:{
                  type: Array,
                },
                _result:{
                    type: Array
                },
                voornaam: {
                    type: String
                },
                achternaam: {
                    type: String
                },
                adres: {
                    type: String
                },
                plaats:{
                    type: String
                },
                telnummer: {
                    type: String
                },
                email:{
                    type: String
                },
                datum:{
                    type: String
                },
                naam:{
                    type: String
                },
                hide: {
                    type: Boolean,
                    value: true // init the value to true so it will be hidden on page load
                },
                c_visible: {
                    type: Boolean, /* true when element is the active visible item */
                    value: false,
                    observer: '_initializing', /* wordt ook aangeroepen bijwisseling van true naar false.
                     regel in de functie dat er niets gebeurd
                     als c_visible false is */
                },
            },

            _initializing: function() {
                if (this.c_visible) {
                    this._medewerkers_ophalen_request_handler();
                }
            },

            _medewerkers_ophalen_request_handler: function () {
                this.$.ajax_medewerkers_ophalen.generateRequest();
            },
            _medewerkers_ophalen_response_handler: function (request) {
                this._c_medewerkers = request.detail.response;
            },

            _rooster_medewerker_ophalen_request_handler: function () {
                this.$['ajax_rooster_ophalen'].contentType = "application/json";
                this.$['ajax_rooster_ophalen'].body = {
                    "naam": this.naam,
                    "datum": this.datum,
                    "data": this._c_medewerkers,
                };
                this.$['ajax_rooster_ophalen'].generateRequest();
                this.hide = false;

            },
            _rooster_medewerker_ophalen_response_handler: function (request) {
                this._result = request.detail.response;
                console.log(this._result)
            },

            medewerker_rooster_ophalen: function () {
                var combobox = document.body.querySelectorAll('#medewerker');
                var datepicker = document.body.querySelectorAll('#date');
                var volnaam = combobox[1].value;
                var datum = datepicker[3].value;
                this.naam = volnaam;
                this.datum = datum;
                this._rooster_medewerker_ophalen_request_handler()
            }

        });
    </script>
</dom-module>
